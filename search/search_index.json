{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"Step 1<pre><code>    Install and configure Pihole DNS Add-on for Splunk\n</code></pre> <ul> <li>Complete logging requirements</li> <li>Install on Indexers, Search Heads</li> <li>Configure inputs on Forwarders</li> </ul> <p>See Documentation  View on Splunkbase</p> Step 2<pre><code>    Install and configure Pihole DNS App for Splunk\n</code></pre> <p></p> <ul> <li>Install dependencies</li> <li>Install only on Search Head</li> <li>(recommended) Configure app</li> </ul> <p>See Documentation  View on Splunkbase</p>"},{"location":"landing-page/","title":"Pi-hole Add-on (TA-pihole_dns)","text":"<p>Disclaimer</p> <p>This Splunk app is not affiliated with Pi-hole\u00ae and is not sponsored or sanctioned by the Pi-hole\u00ae team. As such, the included documentation does not contain information on how to get started with the Pi-hole DNS server. Rather, this documentation serves as a guide to help visualize the data in Splunk. Please visit https://pi-hole.net for documentation on installing/configuring your own Pi-hole server.</p> <p>Pi-hole is and the Pi-hole logo are registered trademarks of Pi-hole LLC.</p> <p>The Pi-hole Add-on allows Splunk data administrators to map the Pi-Hole\u00ae DNS server events to the CIM enabling the data to be used with other Splunk Apps, such as the Pihole App for Splunk.</p>"},{"location":"landing-page/#assumptions","title":"Assumptions","text":"<p>This documentation assumes the following:</p> <ol> <li>You have a working Pi-hole server.</li> <li>You have a working Splunk environment.</li> <li>Basic understanding of Splunk and Pi-hole.</li> </ol>"},{"location":"landing-page/#about","title":"About","text":"Info Description Version 1.3.3 - Splunkbase | GitHub Vendor Product Version Pi-hole\u00ae v5.x, FTL 5.x Splunk CIM 5.x, 4.x Add-on has a web UI Yes, this Add-on contains a configuration page for the Modular Input. <p>Get Started</p>"},{"location":"getting-started/pihole-logging-requirements/","title":"Pi-hole Logging Requirements","text":"<p>Danger, Will Robinson</p> <p>Failing to perform the following will cause this add-on to not extract fields properly</p> <p>Set <code>log-queries=extra</code> in the pihole dnsmasq configuration file. Pi-hole\u00ae recommends to make any changes to a new configuration file to avoid changes to be overridden during an update.</p> <ol> <li>Create a new file: <code>/etc/dnsmasq.d/02-pihole-splunk.conf</code>.</li> <li>Add <code>log-queries=extra</code> to the file. save and close the file</li> <li>Restart pi-hole with <code>pihole restartdns</code></li> </ol>"},{"location":"getting-started/where-to-install/","title":"Installation Overview","text":"<p>There are two components to install on your Splunk software.</p> - Type Name Package Name Splunkbase App Pi-hole DNS App for Splunk <code>pihole_dns_app</code> https://splunkbase.splunk.com/app/4506 Add-on Pi-hole DNS Addon for Splunk <code>TA-pihole_dns</code> https://splunkbase.splunk.com/app/4505"},{"location":"getting-started/where-to-install/#there-are-two-methods-for-deployment","title":"There are two methods for deployment","text":"<ol> <li>Single instance deployment</li> <li>Distributed deployment</li> </ol> <p>For detailed information on where to install Splunk Apps/add-ons, including best practices, can be found at Splunk Docs: About Installing Splunk add-ons</p>"},{"location":"getting-started/where-to-install/#single-instance-deployments","title":"Single instance Deployments","text":"<p>Install the App and add-on to the single instance. For more information see Splunk Docs: Install add-on in a single-instance Splunk deployment</p> <p> </p>"},{"location":"getting-started/where-to-install/#distributed-deployments","title":"Distributed Deployments","text":"Splunk Instance type Install App Install Add-on Comments Search Heads Yes Yes Install app and add-on to all search heads. Indexers No Yes Install only the Add-on. Heavy Forwarders No Yes Install only the Add-on. Universal Forwarders (UF) No Not required The add-on includes an inputs.conf file that is disabled by default. This can be used to create an input on the forwarder if enabled. <p>The installation steps for deploying Apps/add-ons in a distributed environment can be found at Splunk Docs: Install an add-on in a distributed Splunk deployment</p> <p> </p>"},{"location":"getting-started/where-to-install/#distributed-deployment-compatibility","title":"Distributed Deployment Compatibility","text":"Distributed deployment feature Supported Comments Search Head Clusters Yes You can install this add-on to a search head cluster. Indexer Clusters Yes You can install this add-on to a indexer cluster. Deployment Server Yes You can use a deployment server to push this add-on to Splunk Universal Forwarders. <p>* For more information, see Splunk's documentation on installing Add-ons.</p>"},{"location":"getting-started/configure-inputs/configure-inputs/","title":"Configure Splunk Input","text":"<p>Objective: Set the sourcetype to <code>pihole</code> in the inputs.conf file on the forwarder.</p>"},{"location":"getting-started/configure-inputs/configure-inputs/#create-an-index","title":"Create an Index","text":"Optional <p>If you do not wish to create a new index, skip to Splunk Universal Forwarder Configuration.</p> <p>Splunk stores data in indexes. This add-on may be configured to send to a custom event index instead of the default index, main. For more information and steps to create a new index, see Splunk Docs: Create events indexes.</p>"},{"location":"getting-started/configure-inputs/configure-inputs/#purpose-for-creating-a-new-index","title":"Purpose for Creating a new index","text":"<p>The out of the box Splunk configuration stores all data in the default index, main. It is encouraged to create a new index to ensure optimal performance, for setting retention policies, and for providing stricter access controls. For more information about how Splunk indexes work with add-ons, see Splunk Docs: Add-ons and indexes.</p>"},{"location":"getting-started/configure-inputs/configure-inputs/#splunk-universal-forwarder-configuration","title":"Splunk Universal Forwarder Configuration","text":"<p>Before Proceeding</p> <p>Ensure the Pi-hole logging requirement has been completed. Failure to set <code>log-queries=extra</code> will cause this add-on to not extract fields properly.</p> Note <p>Unless utilizing a syslog server, this UF should be installed on the same server as the Pi-Hole server.</p> <p>Download the latest Splunk Universal Forwarder (UF) appropriate for your server.</p> <p>Install the UF according to Splunk Docs: Install the Universal Forwarder.</p> <p>Once installed the configurations can be made. The following is a sample inputs.conf that can be pushed using a deployment server or configured on the UF itself. Place the following configurations in the <code>../local/inputs.conf</code> file.</p> inputs.conf<pre><code>[monitor:///var/log/pihole.log]\ndisabled = 0\nsourcetype = pihole\n# optionally specify an index, if configured.\n# index = dns\n[monitor:///var/log/pihole-FTL.log]\ndisabled = 0\nsourcetype = pihole:ftl\n# optionally specify an index, if configured.\n# index = dns_system\n</code></pre> <p>Push the configuration to the forwarder, if using a deployment server, or restart the UF if configuring on the UF itself.</p>"},{"location":"getting-started/configure-inputs/configure-inputs/#verify","title":"Verify","text":"<p>Verify the setup has completed successfully by navigating to Splunk web and running a search similar to the following:</p> <pre><code>index=&lt;chosen index&gt; sourcetype=pihole*\n</code></pre> <p>If you see data then you are all set! Proceed to Configuring Modular Inputs or start visualizing your data by downloading and installing the Pihole App for Splunk.</p> <p>If you are not seeing your data, see Troubleshooting Monitoring Inputs.</p>"},{"location":"getting-started/configure-inputs/configure-modinput/","title":"Configure Modular Input","text":"<p>The TA-pihole_dns modular input will interact with the Pi-hole FTL API using GET requests. </p> <p>Warning</p> <p>The current Pi-hole HTTP API requires a plaintext API key passed as a parameter. </p>"},{"location":"getting-started/configure-inputs/configure-modinput/#add-on-prerequisites","title":"Add-on Prerequisites","text":"<p>The Pihole Add-on for Splunk must be set to visible in order to configure the modular input.</p> <ol> <li>In Splunk web, navigate to the \"Manage Apps\" view by clicking the gear icon on the Launcher page or click \"Manage Apps\" from the \"Apps\" dropdown next to the Splunk logo on the top left of the screen.</li> <li>In the app list search for \"Pihole DNS Add-on\" and click \"Edit properties\" on the right side.</li> <li>Ensure \"Visible\" is set to Yes and save.</li> </ol>"},{"location":"getting-started/configure-inputs/configure-modinput/#updating-to-new-modular-inputs","title":"Updating to new modular Inputs","text":"<p>The following steps are only applicable if you have setup a modular input prior to version 1.3.0. Version 1.3.0 and later can skip to Setting up new Modular Inputs</p> <ol> <li>After updating to version 1.3.0 proceed to the Pihole DNS Add-on in Splunk Web.</li> <li>Navigate to Configuration &gt; Account (Tab)</li> <li>Add a new account. The Steps to add a new account can be found below under Create Account</li> <li>After creating a new account, navigate to Inputs.</li> <li>On the existing Input, click Actions &gt; Edit.</li> <li>for the \"Pihole Account\" option, select the created account.</li> <li>Click Update.</li> <li>Complete! To add additional Pi-hole servers, continue on to the next steps.</li> </ol>"},{"location":"getting-started/configure-inputs/configure-modinput/#setting-up-new-modular-input","title":"Setting up new Modular Input","text":"Tested Versions <p>Pi-hole v5.2.4 | Web Interface v5.4 | FTL v5.7</p> <p>Add-on Version 1.3.0</p>"},{"location":"getting-started/configure-inputs/configure-modinput/#modular-input-prerequisites","title":"Modular Input Prerequisites","text":"<ul> <li>Obtain API Credentials</li> <li>FQDN/IP of the Pi-hole Instance(s).</li> <li>Splunk must be able to reach the Pi-hole server on port 80/tcp.</li> </ul>"},{"location":"getting-started/configure-inputs/configure-modinput/#obtain-api-credentials","title":"Obtain API Credentials","text":"<p>If you are not using a password to log in to the Pi-hole web interface, skip to Create Account</p> <ol> <li>Log in to the Pi-hole web interface.</li> <li>Navigate to Settings &gt; API/Web Interface.</li> <li>Click \"Show API token.\"</li> <li>Save this token for later steps.</li> </ol>"},{"location":"getting-started/configure-inputs/configure-modinput/#create-account","title":"Create Account","text":"<p>At least one account is needed for the modular input to work.</p> <ol> <li>Verify Prerequisites have been completed before proceeding. </li> <li>Log in to the Splunk web interface.</li> <li> <p>Navigate to the Pi-hole Add-on for Splunk &gt; Configuration (Tab).</p> Not seeing the Pihole Add-on? <p>Verify the Add-on Prerequistes have been completed.</p> </li> <li> <p>Add a new Account.</p> </li> <li>Enter a name for the account.</li> <li>Enter the API key. Note: if you are not using a password to authenticate to your Pi-hole instance, enter any text here.</li> <li>Enter the IP/FQDN of the Pi-hole instance.</li> <li>Click add.</li> <li>(optional) Configure proxy</li> <li>(optional) Set logging level</li> </ol>"},{"location":"getting-started/configure-inputs/configure-modinput/#create-input","title":"Create Input","text":"<ol> <li>Navigate to the Input tab.</li> <li>Click \"Create New Input\"</li> <li>(optional) Create input for System Summary Events see Modular Input Reference.</li> <li>(optional) Create input for Filter Events see Modular Input Reference.</li> <li>For the selected input, enter a unique name, index, and an interval to run in seconds. Minimum: 300 (5 minutes).</li> <li>Click add.</li> </ol>"},{"location":"getting-started/configure-inputs/configure-modinput/#verify","title":"Verify","text":"<p>Once completed the modular input will immediately run. To verify open up a search and run a similar query:</p> <pre><code>index=&lt;chosen index&gt; sourcetype=pihole:*\n</code></pre> <p>If data does not appear within a few minutes, see Troubleshooting Modular Inputs.</p>"},{"location":"getting-started/troubleshooting/troubleshoot-inputs/","title":"Troubleshoot Monitoring Inputs","text":"<p>There is a variety of issues when getting new data into Splunk. Below are a few of the most common issues:</p> Issue Description Solution Limited or no field extractions Fields are not extracted during search time. Confirm the sourceytpe has been set to <code>pihole</code>. If the sourcetype is already set correctly be sure that the Pi-hole logging requirements has been completed. Splunk cannot read the file If the user running Splunk (default is <code>splunk</code>) cannot read the contents of the file, the data will not be sent to Splunk. log in as the Splunk user and verify the contents can be read. If not, update the permissions of the file to allow read access to the Splunk user. Incorrect timestamps Having the incorrect time setup on either the Splunk instance or Pi-hole server may result in not ingesting the data. In Splunk web, try switching the time range to \"All Time\" when looking for the Pi-hole data. If the data is found and the incorrect time is observed, update the servers to the correct time and consider utilizing a NTP server for proper time synchronization. Splunk Forwarder communication It is possible that the Splunk Universal Forwarder does not have a connection to the Splunk instance. Verify connection by running the following command on the universal forwarder: <code>$SPLUNK_HOME/bin/splunk list forward-server</code>. $SPLUNK_HOME is the installation directory. The output from this command will show active/inactive connections to the Splunk Instance. Alternatively the internal logs can be searched in Splunk Web. Run the following command on the search head: <code>index=_internal source=*metrics.log* tcpin_connections | stats count by sourceIp</code>. The output of this search will show a list of sources connecting to the Splunk Instance. <p>For more troubleshooting steps, see Splunk Docs: Troubleshooting Data.</p>"},{"location":"getting-started/troubleshooting/troubleshoot-modinputs/","title":"Modular Input Troubleshooting","text":"<p>If no logs appear in the index you specified after configuring the input, use the following to troubleshoot.</p> <ol> <li>Set the logging mode to \"Debug\" on the Configuration Tab.</li> <li>Search the internal logs for errors:</li> </ol> <pre><code>index=_internal sourcetype=\"tapiholedns:log\"\n</code></pre>"},{"location":"reference/credits/","title":"Credits","text":"<p>This add-on was developed using the Splunk Add-on Builder.</p>"},{"location":"reference/mod-input-reference/","title":"Modular Input Details","text":"<p>The Modular input can be setup to collect from a few different endpoints. The Pi-hole API is limited and more data will be available through upcoming releases.</p> Mod Input Description System Summary Events This input will pull summary information including domains in database, version, and when gravity was last updated. Filter Events This input will pull the configured regex and domain filters create in Pi-hole to block or allow domains."},{"location":"reference/sourcetypes/","title":"Sourcetypes","text":"<p>Below are a list of sourcetypes which this Add-on uses. It is not necessary to manually set the sourcetype to anything other than <code>pihole</code> as this add-on will automatically transform the sourcetype to the appropriate value.</p> Sourcetype Description CIM Data Models <code>pihole</code> Pi-hole DNS events Network Resolution <code>pihole:dhcp</code> Pi-hole DHCP events Network Sessions <code>pihole:ftl</code> Pi-hole FTL events None <code>pihole:system</code> Pi-hole API data None <code>pihole:filters</code> Pi-hole API data for filters None <code>pihole:lists</code> Pi-hole lists None"},{"location":"reference/releases/","title":"Release notes for the Pi-hole Add-on for Splunk","text":""},{"location":"reference/releases/#v134-august-4-2024","title":"v1.3.4 August 4, 2024","text":""},{"location":"reference/releases/#compatibility","title":"Compatibility","text":"Product Version Splunk platform versions 9.x, 8.x CIM 5.x Pi-hole Versions Pi-hole\u00ae v5.x, FTL 5.x"},{"location":"reference/releases/#updated","title":"Updated","text":"<ul> <li>Added configs for DHCP logs to be more CIM Compliant - Thanks @adriankaylor</li> </ul>"},{"location":"reference/releases/#known-issues","title":"Known issues","text":"<p>This version of the Pi-hole Add on for Splunk has the following known issues. If no issues appear here, no issues have been reported. Issues can be reported on the Pi-hole add on for Splunk's Github page.</p>"},{"location":"reference/releases/release-history/","title":"Release history for the Pi-hole Addon for Splunk","text":"<p>The latest version of the Pi-hole Addon for Splunk is version 1.3.4. See Release notes for the Pi-hole Add on for Splunk of the latest version.</p>"},{"location":"reference/releases/release-history/#v133-august-24-2023","title":"v1.3.3 August 24, 2023","text":""},{"location":"reference/releases/release-history/#updated","title":"Updated","text":"<ul> <li>Fixed issue with Api Port in modular input - #56</li> <li>Updated Splunklib</li> </ul>"},{"location":"reference/releases/release-history/#v132-july-20-2022","title":"v1.3.2 July 20, 2022","text":""},{"location":"reference/releases/release-history/#new","title":"New","text":"<ul> <li>Added dest field to map to CIM.</li> <li>Added dest_port field to forwarded events.</li> <li>Added new special domain block field extractions (see Pi-hole pull request for more info: https://github.com/pi-hole/FTL/pull/1338).</li> <li>Added query_type field.</li> </ul>"},{"location":"reference/releases/release-history/#updated_1","title":"Updated","text":"<ul> <li>Updated to new AOB version.</li> <li>Updated pihole eventtype.</li> </ul>"},{"location":"reference/releases/release-history/#removed","title":"Removed","text":"<ul> <li>Removed pihole_lists script</li> <li>Removed special characters from reply_code field.</li> </ul>"},{"location":"reference/releases/release-history/#v131-july-8-2021","title":"v1.3.1 July 8, 2021","text":"<ul> <li>updated field extractions to include dnssec query events introduced in new Pi-Hole version (Core: v5.4, FTL v5.9).</li> <li>fixed issue causing internal logs to produce a checkpointer not defined error #28</li> </ul>"},{"location":"reference/releases/release-history/#v130-april-28-2021","title":"v1.3.0 April 28, 2021","text":"<p>Note</p> <p>This update changes the way the modular input works. If existing modular inputs were setup prior to this version, action must be taken to ensure those inputs continue to function correctly. See Updating to new modular inputs for more information.</p> <ul> <li>Added ability to pull regex and domain filters created in the Pi-hole server.</li> <li>Updated the Modular input to make more flexible.</li> <li>With the upcoming version of Pi-hole\u00ae 6.0, the scripted input \"pihole_lists.sh\" will be deprecated. This information will be available through the REST API in the upcoming release.</li> </ul>"},{"location":"reference/releases/release-history/#v128-feb-20-2021","title":"v1.2.8 Feb 20, 2021","text":"<ul> <li>Added scripted input to ingest lists which enable the mapping of blocked queries to originating blocklists -&gt; #21</li> </ul>"},{"location":"reference/releases/release-history/#v127-dec-21-2020","title":"v1.2.7 Dec 21, 2020","text":"<ul> <li>Added Modular Input for pulling select data from the HTTP API.</li> </ul>"},{"location":"reference/releases/release-history/#v126-oct-18-2020","title":"v1.2.6 Oct 18, 2020","text":"<ul> <li>Fixed Regex/Exact query blacklist events not being extracted -&gt; Issue #9</li> <li>Fixed HTTPS record types fixed (type=65) -&gt; Issue #10</li> </ul>"},{"location":"reference/releases/release-history/#v125-sept-1-2020","title":"v1.2.5 Sept 1, 2020","text":"<ul> <li>Added compatibility for DHCP events.</li> <li>New sourcetype: pihole:dhcp.</li> </ul>"}]}