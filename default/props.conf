# DO NOT EDIT THIS FILE!
# Please make all changes to files in $SPLUNK_HOME/etc/apps/TA_pihole_dns/local.
# To make changes, copy the section/stanza you want to change from $SPLUNK_HOME/etc/apps/TA_pihole_dns/default
# into ../local and edit there.

#====================================
# pihole Global Settings
#====================================
[(::zTs){0}pihole*]
TRANSFORMS-zzz_pihole_length = pihole_raw_length
ANNOTATE_PUNCT               = false
KV_MODE                      = none
EVAL-vendor_product          = "Pi-hole"

#====================================
# pihole
#====================================
[pihole]
category                      = Pihole Add-on
description                   = Pihole DNS logs
SHOULD_LINEMERGE              = false
LINE_BREAKER                  = ([\r\n]+)
NO_BINARY_CHECK               = true
CHARSET                       = UTF-8
TRANSFORMS-pihole_sourcetyper = pihole_sourcetyper
REPORT-pihole_config          = pihole_config
REPORT-pihole_dest            = pihole_dest
REPORT-pihole_forwarded       = pihole_forwarded
REPORT-pihole_gravity         = pihole_gravity
REPORT-pihole_regex_block     = pihole_regex_block
REPORT-pihole_exact_block     = pihole_exact_block
REPORT-pihole_pid             = pihole_pid
REPORT-pihole_query           = pihole_query
REPORT-pihole_response        = pihole_response
REPORT-pihole_src_src_port    = pihole_src_src_port
REPORT-pihole_transaction_id  = pihole_transaction_id
REPORT-pihole_validation      = pihole_validation
FIELDALIAS-pihole_dest        = host ASNEW dest
FIELDALIAS-pihole_src         = src_ip ASNEW src
EVAL-name                     = if(match(name, "\/etc.*"), "local_list_reply",name)
EVAL-reply_code               = case(isnotnull(reply_code), reply_code, isnotnull(answer) AND answer=="0.0.0.0", "Refused", vendor_action == "blocked", "Refused", isnull(answer), null(), true(), "NoError")
EVAL-record_type              = if(record_type=="type=65", "HTTPS", record_type)
LOOKUP-pihole_rcodes          = pihole_rcodes_lookup name AS reply_code OUTPUTNEW rcode AS reply_code_id,     description AS rcode_decription
LOOKUP-pihole_rtypes          = pihole_rtypes_lookup type AS record_type OUTPUTNEW type_id AS record_type_id, description AS record_description

#====================================
# pihole FTL
#====================================
[pihole:ftl]
category         = Pihole Add-on
description      = Pihole FTL logs
SHOULD_LINEMERGE = false
LINE_BREAKER     = ([\r\n]+)
NO_BINARY_CHECK  = true
TIME_FORMAT      = %Y-%m-%d %H:%M:%S.%3N
TIME_PREFIX      = ^\[
MAX_TIMESTAMP_LOOKAHEAD     = 23
CHARSET                     = UTF-8
REPORT-pihole_ftl_metrics   = pihole_ftl_metrics
REPORT-pihole_ftl_config    = pihole_ftl_config
REPORT-pihole_ftl_msg       = pihole_ftl_msg
REPORT-pihole_ftl_blacklist = pihole_ftl_blacklist

#====================================
# pihole DHCP
#====================================
[pihole:dhcp]
category                      = Pihole Add-on
description                   = Pihole DHCP logs
SHOULD_LINEMERGE              = false
LINE_BREAKER                  = ([\r\n]+)
NO_BINARY_CHECK               = true
CHARSET                       = UTF-8
REPORT-pihole_dhcp_events     = pihole_dhcp_events
REPORT-pihole_dhcp_lease      = pihole_dhcp_lease
REPORT-pihole_dhcp_lease_info = pihole_dhcp_lease_info
FIELDALIAS-pihole_dhcp_rename = client_ip ASNEW dest_ip, client_mac ASNEW dest_mac, client_name ASNEW dest_nt_host, host ASNEW dvc
EVAL-lease_time               = replace(lease_time, "d", " day(s)")

#====================================
# pihole Version
#====================================
[pihole:version]
category            = Pihole Add-on
description         = Pihole Version.
SHOULD_LINEMERGE    = false
INDEXED_EXTRACTIONS = json
DATETIME_CONFIG     = CURRENT

#====================================
# pihole Domains
#====================================
[pihole:domains]
category            = Pihole Add-on
description         = Regex and Domain filters created in the Pi-hole server.
SHOULD_LINEMERGE    = false
INDEXED_EXTRACTIONS = json
DATETIME_CONFIG     = CURRENT

#====================================
# pihole FTL DBInfo
#====================================
[pihole:dbinfo]
category            = Pihole Add-on
description         = FTL database information.
SHOULD_LINEMERGE    = false
INDEXED_EXTRACTIONS = json
DATETIME_CONFIG     = CURRENT

#====================================
# pihole System Info
#====================================
[pihole:sysinfo]
category            = Pihole Add-on
description         = System information.
SHOULD_LINEMERGE    = false
INDEXED_EXTRACTIONS = json
DATETIME_CONFIG     = CURRENT

#====================================
# pihole Lists
#====================================
[pihole:lists]
category            = Pihole Add-on
description         = Pihole Lists.
SHOULD_LINEMERGE    = false
INDEXED_EXTRACTIONS = json
DATETIME_CONFIG     = CURRENT
FIELDALIAS-pihole_lists_group = "groups{}" ASNEW groups

#====================================
# pihole Clients
#====================================
[pihole:clients]
category            = Pihole Add-on
description         = Pihole Clients.
SHOULD_LINEMERGE    = false
INDEXED_EXTRACTIONS = json
DATETIME_CONFIG     = CURRENT

#====================================
# pihole Groups
#====================================
[pihole:groups]
category            = Pihole Add-on
description         = Pihole Groups.
SHOULD_LINEMERGE    = false
INDEXED_EXTRACTIONS = json
DATETIME_CONFIG     = CURRENT

#====================================
# pihole Status
#====================================
[pihole:status]
category            = Pihole Add-on
description         = Pihole blocking status.
SHOULD_LINEMERGE    = false
INDEXED_EXTRACTIONS = json
DATETIME_CONFIG     = CURRENT

#====================================
# pihole DNS Cache
#====================================
[pihole:cache]
category            = Pihole Add-on
description         = Pihole DNS Cache Usage.
SHOULD_LINEMERGE    = false
INDEXED_EXTRACTIONS = json
DATETIME_CONFIG     = CURRENT

#====================================
# pihole Latest Release
#====================================
[pihole:latest]
category            = Pihole Add-on
description         = Pihole latest release check
SHOULD_LINEMERGE    = false
INDEXED_EXTRACTIONS = json
DATETIME_CONFIG     = CURRENT

#====================================
# pihole Modular Input Log
#====================================
[source::...ta-pihole_dns*.log*]
SHOULD_LINEMERGE = true
sourcetype       = tapiholedns:log

[source::...ta_pihole_dns*.log*]
SHOULD_LINEMERGE = true
sourcetype       = tapiholedns:log
